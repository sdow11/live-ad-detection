# Base Ad Detection Model Configuration

# Model Architecture
model:
  name: "base-ad-detector"
  architecture: "efficientnet_lite0"
  input_shape: [224, 224, 3]
  num_classes: 1  # Binary classification (ad vs content)
  dropout_rate: 0.3
  use_pretrained: true
  freeze_backbone: false  # Set to true for transfer learning

# Dataset
data:
  train_dir: "data/train"
  val_dir: "data/val"
  test_dir: "data/test"
  batch_size: 32
  num_workers: 4
  shuffle: true

  # Data augmentation
  augmentation:
    enabled: true
    random_crop: true
    random_flip: true
    random_brightness: 0.2
    random_contrast: 0.2
    random_saturation: 0.2
    random_hue: 0.1
    random_rotation: 15  # degrees
    cutout_probability: 0.3
    cutout_size: 32

  # Preprocessing
  preprocessing:
    resize: [256, 256]  # Resize before crop
    center_crop: [224, 224]  # Final size
    normalize: true
    mean: [0.485, 0.456, 0.406]  # ImageNet
    std: [0.229, 0.224, 0.225]   # ImageNet

# Training
training:
  epochs: 50
  learning_rate: 0.001
  optimizer: "adam"
  weight_decay: 0.0001
  momentum: 0.9  # For SGD

  # Learning rate schedule
  lr_schedule:
    type: "cosine"  # or "step", "exponential"
    warmup_epochs: 5
    min_lr: 0.00001

  # Loss function
  loss:
    type: "binary_crossentropy"
    label_smoothing: 0.1

  # Class balancing (if dataset is imbalanced)
  class_weights:
    enabled: true
    auto: true  # Auto-compute from dataset
    # manual: [0.5, 0.5]  # Or specify manually

  # Early stopping
  early_stopping:
    enabled: true
    patience: 10
    monitor: "val_loss"
    mode: "min"

  # Model checkpointing
  checkpointing:
    enabled: true
    save_best_only: true
    monitor: "val_f1_score"
    mode: "max"
    save_frequency: 5  # Save every N epochs

# Validation
validation:
  frequency: 1  # Validate every N epochs
  metrics:
    - "accuracy"
    - "precision"
    - "recall"
    - "f1_score"
    - "auc_roc"

# Testing
testing:
  metrics:
    - "accuracy"
    - "precision"
    - "recall"
    - "f1_score"
    - "confusion_matrix"
  threshold: 0.5  # Classification threshold

# Conversion to TFLite
conversion:
  quantization: "int8"
  representative_samples: 100
  target_hardware: "raspberry_pi_5"

# Deployment
deployment:
  min_precision: 0.95
  min_recall: 0.90
  max_latency_ms: 50  # On Raspberry Pi 5
  max_size_mb: 5

# Experiment Tracking
tracking:
  enabled: true
  backend: "mlflow"  # or "wandb", "tensorboard"
  experiment_name: "base-ad-detector"
  tags:
    - "base-model"
    - "efficientnet-lite0"
    - "general-purpose"

# Random seed for reproducibility
seed: 42
